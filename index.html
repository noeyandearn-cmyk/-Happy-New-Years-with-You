<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Our Memory - MOMENT√â</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    <style>
        :root { --primary-pink: #ff4d6d; --bg-dark: #000; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background-color: var(--bg-dark); overflow: hidden; font-family: 'Kanit', sans-serif; color: white; }
        
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô */
        .page { display: none; flex-direction: column; justify-content: center; align-items: center; height: 100vh; text-align: center; position: absolute; width: 100%; top: 0; left: 0; z-index: 10; }
        .active { display: flex; }
        .brand { position: absolute; bottom: 30px; width: 100%; text-align: center; color: #444; font-size: 0.7rem; letter-spacing: 2px; z-index: 15; }

        /* ‡∏´‡∏ô‡πâ‡∏≤ 1: ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡∏¥‡∏î‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç */
        .gift-button { background: white; color: black; border: none; padding: 15px 45px; border-radius: 50px; font-size: 1.2rem; font-weight: bold; cursor: pointer; box-shadow: 0 0 30px rgba(255, 255, 255, 0.4); transition: 0.3s; }
        .gift-button:active { transform: scale(0.9); }

        /* ‡∏´‡∏ô‡πâ‡∏≤ 3: ‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤ */
        .names { font-family: 'Dancing Script', cursive; font-size: 3.5rem; text-shadow: 0 0 15px var(--primary-pink); margin: 0; }
        .names span { color: var(--primary-pink); }
        .counter-box { background: rgba(255,255,255,0.1); padding: 15px 25px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.2); margin: 20px 0; backdrop-filter: blur(5px); }
        .time-highlight { color: var(--primary-pink); font-weight: bold; font-size: 1.5rem; }

        /* ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏¥‡πä‡∏Å‡∏ã‡∏≠‡∏ß‡πå & Pop-up */
        .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); justify-content: center; align-items: center; z-index: 100; }
        .card { background: white; padding: 25px; border-radius: 30px; width: 85%; max-width: 320px; color: #333; position: relative; }
        #puzzle-container { display: grid; grid-template-columns: repeat(3, 1fr); gap: 2px; background: #ddd; margin-top: 15px; }
        .puzzle-piece { width: 100%; aspect-ratio: 1/1; background-size: 300% 300%; cursor: pointer; border: 0.5px solid rgba(255,255,255,0.5); }
        .success-box { background: white; color: black; padding: 20px 50px; border-radius: 50px; font-size: 1.2rem; font-weight: bold; cursor: pointer; box-shadow: 0 0 30px white; }

        /* ‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏≤‡∏£‡πå‡∏î Happy New Year */
        .ny-card { width: 85%; max-width: 350px; background: white; border-radius: 40px; padding: 30px 20px; color: #333; position: relative; animation: slideUp 0.8s ease; }
        @keyframes slideUp { from { transform: translateY(100px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .ny-card h2 { margin: 0; font-size: 1.6rem; letter-spacing: 1px; }
        .ny-card p { font-size: 0.85rem; line-height: 1.6; color: #555; padding: 0 10px; margin: 15px 0; }
        .polaroid { background: white; padding: 10px 10px 30px 10px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); margin: 15px auto; width: 180px; transform: rotate(-2deg); cursor: pointer; transition: 0.3s; }
        .polaroid:active { transform: scale(0.95) rotate(0deg); }
        .polaroid img { width: 100%; height: 180px; object-fit: cover; }
        .btn-miss { background: #ff8fa3; color: white; border: none; padding: 12px 30px; border-radius: 30px; font-size: 1rem; cursor: pointer; margin-top: 10px; display: flex; align-items: center; gap: 8px; width: 100%; justify-content: center; font-weight: bold; }

        /* Canvas ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏•‡∏∏ */
        canvas { position: absolute; top: 0; left: 0; pointer-events: none; z-index: 5; }
        #final-text { display: none; position: fixed; top: 50%; width: 100%; text-align: center; font-size: 2.2rem; font-weight: bold; color: white; text-shadow: 0 0 20px var(--primary-pink); z-index: 200; pointer-events: none; }
    </style>
</head>
<body>

    <audio id="bgMusic" loop>
        <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
    </audio>

    <canvas id="fireworksCanvas"></canvas>

    <div id="page1" class="page active">
        <button class="gift-button" onclick="startApp()">‡πÅ‡∏ï‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç üéÅ</button>
        <div class="brand">MOMENT√â</div>
    </div>

    <div id="page2" class="page" onclick="goToCounter(event)">
        <div style="color:rgba(255,255,255,0.4)">‡∏à‡∏¥‡πâ‡∏°‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏ó‡∏µ.. ‚ú®</div>
        <div class="brand">MOMENT√â</div>
    </div>

    <div id="page3" class="page" onclick="showPuzzle()">
        <h1 class="names">PP <span>‚ù§Ô∏è</span> Put</h1>
        <div class="counter-box">
            <div>‡πÄ‡∏£‡∏≤‡∏£‡∏±‡∏Å‡∏Å‡∏±‡∏ô‡∏°‡∏≤ <span id="days" class="time-highlight">0</span> ‡∏ß‡∏±‡∏ô</div>
            <div><span id="hours" class="time-highlight">0</span> ‡∏ä‡∏°. <span id="minutes" class="time-highlight">0</span> ‡∏ô‡∏≤‡∏ó‡∏µ <span id="seconds" class="time-highlight">0</span> ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</div>
        </div>
        <div style="font-size:0.8rem; color:#666;">(‡πÅ‡∏ï‡∏∞‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à ü•∞)</div>
        <div class="brand">MOMENT√â</div>

        <div id="puzzle-overlay" class="overlay" onclick="event.stopPropagation()">
            <div class="card">
                <b style="font-size: 0.9rem;">‡∏ä‡πà‡∏ß‡∏¢‡∏ï‡πà‡∏≠‡∏à‡∏¥‡πä‡∏Å‡∏ã‡∏≠‡∏ß‡πå‡∏£‡∏π‡∏õ‡πÄ‡∏£‡∏≤‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏´‡∏ô‡πà‡∏≠‡∏¢‡∏ô‡∏∞... üß©</b>
                <div id="puzzle-container"></div>
                <div style="font-size: 0.6rem; color: #ccc; margin-top: 10px;">MOMENT√â</div>
            </div>
        </div>
    </div>

    <div id="success-overlay" class="overlay" onclick="goToNYCard()">
        <div class="success-box">‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å! ‡∏£‡∏±‡∏Å‡∏ô‡∏∞ ü•∞</div>
    </div>

    <div id="page4" class="page">
        <div class="ny-card">
            <h2>Happy New Year üéÜü§ç</h2>
            <p>‡∏î‡∏µ‡πÉ‡∏à‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏à‡∏≠‡∏Å‡∏±‡∏ô‡∏ô‡∏∞ ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏î‡∏µ‡πÜ‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤ ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏µ‡∏Å‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô ‡∏°‡∏µ‡∏£‡∏≠‡∏¢‡∏¢‡∏¥‡πâ‡∏°‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ô‡πÄ‡∏¢‡∏≠‡∏∞‡πÜ ‡∏£‡∏±‡∏Å‡∏Å‡∏±‡∏ô‡∏ô‡∏≤‡∏ô‡πÜ‡πÄ‡∏•‡∏¢</p>
            <b style="color: var(--primary-pink);">‡∏£‡∏±‡∏Å‡∏ô‡∏∞ (‡∏û‡∏∏‡∏í)</b>
            
            <div class="polaroid" onclick="changePhoto()">
                <img id="album-photo" src="" alt="Couple Photo">
                <div style="font-size: 0.6rem; color: #999; margin-top: 5px;">‡πÅ‡∏ï‡∏∞‡∏ó‡∏µ‡πà‡∏£‡∏π‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏π‡∏õ‡∏≠‡∏∑‡πà‡∏ô‡πÜ üì∑</div>
            </div>

            <button class="btn-miss" onclick="finalSurprise(event)">
                üíå ‡∏Å‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏¥‡∏î‡∏ñ‡∏∂‡∏á
            </button>
            <div style="font-size: 0.6rem; color: #ccc; margin-top: 10px;">MOMENT√â</div>
        </div>
    </div>

    <div id="final-text">Happy New Year With You üíñ</div>

    <script>
        // --- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏î‡πâ ---
        const config = {
            startDate: new Date("2024-01-01T00:00:00"), // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Ñ‡∏ö‡∏Å‡∏±‡∏ô (‡∏õ‡∏µ-‡πÄ‡∏î‡∏∑‡∏≠‡∏ô-‡∏ß‡∏±‡∏ô)
            jigsawImage: "https://picsum.photos/300/300", // ‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏ó‡∏≥‡∏à‡∏¥‡πä‡∏Å‡∏ã‡∏≠‡∏ß‡πå
            albumPhotos: [
                "https://picsum.photos/id/64/300/400", // ‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 1
                "https://picsum.photos/id/65/300/400", // ‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 2
                "https://picsum.photos/id/102/300/400", // ‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 3
                "https://picsum.photos/id/103/300/400"  // ‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 4
            ]
        };

        let canvas, ctx, particles = [];
        let puzzleIdx = [0,1,2,3,4,5,6,7,8];
        let currentPhotoIdx = 0;

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
        function startApp() {
            document.getElementById('bgMusic').play();
            showPage('page2');
            initCanvas();
        }

        function goToCounter(e) {
            makeFirework(e.clientX, e.clientY, false);
            setTimeout(() => {
                showPage('page3');
                startTimer();
            }, 800);
        }

        function showPuzzle() {
            document.getElementById('puzzle-overlay').style.display = 'flex';
            setupPuzzle();
        }

        function setupPuzzle() {
            puzzleIdx.sort(() => Math.random() - 0.5);
            const container = document.getElementById('puzzle-container');
            drawPuzzle();
        }

        function drawPuzzle() {
            const container = document.getElementById('puzzle-container');
            container.innerHTML = '';
            puzzleIdx.forEach((val, i) => {
                const div = document.createElement('div');
                div.className = 'puzzle-piece';
                div.style.backgroundImage = `url(${config.jigsawImage})`;
                div.style.backgroundPosition = `${(val % 3) * 50}% ${Math.floor(val / 3) * 50}%`;
                div.onclick = () => {
                    let next = (i + 1) % 9;
                    [puzzleIdx[i], puzzleIdx[next]] = [puzzleIdx[next], puzzleIdx[i]];
                    drawPuzzle();
                    if(puzzleIdx.every((v, index) => v === index)) {
                        setTimeout(() => {
                            document.getElementById('puzzle-overlay').style.display = 'none';
                            document.getElementById('success-overlay').style.display = 'flex';
                        }, 500);
                    }
                };
                container.appendChild(div);
            });
        }

        function goToNYCard() {
            document.getElementById('success-overlay').style.display = 'none';
            showPage('page4');
            document.getElementById('album-photo').src = config.albumPhotos[0];
        }

        function changePhoto() {
            currentPhotoIdx = (currentPhotoIdx + 1) % config.albumPhotos.length;
            const img = document.getElementById('album-photo');
            img.style.opacity = 0;
            setTimeout(() => {
                img.src = config.albumPhotos[currentPhotoIdx];
                img.style.opacity = 1;
            }, 200);
        }

        function finalSurprise(e) {
            const rect = e.target.getBoundingClientRect();
            for(let i=0; i<3; i++) {
                setTimeout(() => makeFirework(rect.left + rect.width/2, rect.top, true), i * 350);
            }
            setTimeout(() => {
                document.getElementById('final-text').style.display = 'block';
                document.getElementById('page4').style.opacity = '0.2';
            }, 1000);
        }

        function showPage(id) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        function startTimer() {
            setInterval(() => {
                const diff = new Date() - config.startDate;
                document.getElementById('days').innerText = Math.floor(diff / 86400000);
                document.getElementById('hours').innerText = Math.floor((diff / 3600000) % 24);
                document.getElementById('minutes').innerText = Math.floor((diff / 60000) % 60);
                document.getElementById('seconds').innerText = Math.floor((diff / 1000) % 60);
            }, 1000);
        }

        // --- ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡∏û‡∏•‡∏∏ ---
        function initCanvas() {
            canvas = document.getElementById('fireworksCanvas');
            ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            function run() {
                ctx.fillStyle = 'rgba(0,0,0,0.2)';
                ctx.fillRect(0,0,canvas.width,canvas.height);
                particles.forEach((p, i) => {
                    p.x += p.vx; p.y += p.vy; p.vy += 0.1; p.a -= 0.012;
                    if(p.a <= 0) particles.splice(i, 1);
                    else {
                        ctx.globalAlpha = p.a;
                        if(p.isHeart) {
                            ctx.font = '24px serif';
                            ctx.fillText('‚ù§Ô∏è', p.x, p.y);
                        } else {
                            ctx.fillStyle = p.c;
                            ctx.beginPath(); ctx.arc(p.x, p.y, 2, 0, 7); ctx.fill();
                        }
                    }
                });
                requestAnimationFrame(run);
            }
            run();
        }

        function makeFirework(x, y, hearts) {
            const hue = Math.random() * 360;
            for(let i=0; i<50; i++) {
                const ang = Math.random() * Math.PI * 2;
                const speed = Math.random() * 6 + 2;
                particles.push({ x, y, vx: Math.cos(ang)*speed, vy: Math.sin(ang)*speed, c: `hsl(${hue},100%,60%)`, a: 1, isHeart: false });
            }
            if(hearts) {
                for(let i=0; i<15; i++) {
                    const ang = Math.random() * Math.PI * 2;
                    const speed = Math.random() * 5 + 1;
                    particles.push({ x, y, vx: Math.cos(ang)*speed, vy: Math.sin(ang)*speed, a: 1, isHeart: true });
                }
            }
        }
    </script>
</body>
</html>